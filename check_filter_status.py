#!/usr/bin/env python3
"""
DiagnÃ³stico rÃ¡pido del filtro MA200
"""
print("="*80)
print("ğŸ” DIAGNÃ“STICO: Estado del Filtro MA200")
print("="*80)
print()

print("ğŸ“‹ INFORMACIÃ“N IMPORTANTE:")
print()
print("Los stocks que reportaste aparecen en tus resultados:")
print("- PYPL (PayPal) - posiciÃ³n 12")
print("- CPRT (Copart) - posiciÃ³n 24")
print("- DIS (Disney) - posiciÃ³n 13")
print()
print("Y dices que 'no han parado de caer', lo que sugiere que estÃ¡n")
print("BAJO su MA200 pero aparecen en los resultados.")
print()

print("="*80)
print("ğŸ¯ PREGUNTAS DE DIAGNÃ“STICO")
print("="*80)
print()

print("Por favor responde estas preguntas:")
print()
print("1ï¸âƒ£  Â¿En quÃ© checkbox estÃ¡ el 'Filtro MA200 (Faber 2007)'?")
print("   a) âœ… MARCADO (activado)")
print("   b) â˜ DESMARCADO (desactivado)")
print()

print("2ï¸âƒ£  Â¿Ves la secciÃ³n 'ğŸ’¾ GestiÃ³n de Datos' en el sidebar?")
print("   a) âœ… SÃ, la veo")
print("   b) âŒ NO, no la veo")
print()

print("3ï¸âƒ£  Si ves la secciÃ³n 'ğŸ’¾ GestiÃ³n de Datos', Â¿quÃ© dice el checkbox?")
print("   a) âœ… 'Usar cachÃ© de precios' estÃ¡ MARCADO")
print("   b) â˜ 'Usar cachÃ© de precios' estÃ¡ DESMARCADO")
print("   c) No veo esta secciÃ³n")
print()

print("4ï¸âƒ£  Â¿CuÃ¡ndo ejecutaste el screening que muestra estos resultados?")
print("   a) Hace menos de 1 hora")
print("   b) Hace mÃ¡s de 1 hora pero hoy")
print("   c) Ayer o antes")
print()

print("5ï¸âƒ£  Â¿Hiciste 'Reboot app' en Streamlit Cloud despuÃ©s del Ãºltimo commit?")
print("   a) âœ… SÃ, reiniciÃ© la app")
print("   b) âŒ NO, no he reiniciado")
print("   c) No estoy usando Streamlit Cloud (ejecuto localmente)")
print()

print("="*80)
print("ğŸ’¡ DIAGNÃ“STICO AUTOMÃTICO")
print("="*80)
print()

print("BasÃ¡ndome en que estos stocks aparecen en tus resultados,")
print("lo MÃS PROBABLE es una de estas causas:")
print()

print("CAUSA #1: FILTRO MA200 DESACTIVADO (Probabilidad: ğŸ”´ ALTA)")
print("-" * 70)
print("El checkbox 'Filtro MA200 (Faber 2007)' estÃ¡ DESMARCADO")
print()
print("âœ… SOLUCIÃ“N:")
print("   1. En el sidebar de Streamlit")
print("   2. Busca la secciÃ³n 'ğŸš€ Filtros Avanzados (NUEVO)'")
print("   3. MARCA el checkbox 'âœ… Filtro MA200 (Faber 2007)'")
print("   4. Re-ejecuta 'ğŸš€ Ejecutar Screening V3'")
print()

print("CAUSA #2: CACHE DESACTUALIZADO (Probabilidad: ğŸŸ¡ MEDIA)")
print("-" * 70)
print("Los datos de precios estÃ¡n cacheados de hace dÃ­as/semanas")
print("En ese momento, PYPL/CPRT/DIS estaban sobre MA200")
print("Pero HOY estÃ¡n bajo MA200")
print()
print("âœ… SOLUCIÃ“N:")
print("   1. En el sidebar, busca 'ğŸ’¾ GestiÃ³n de Datos'")
print("   2. DESMARCA el checkbox 'Usar cachÃ© de precios'")
print("   3. Haz clic en 'ğŸ—‘ï¸ Limpiar CachÃ©'")
print("   4. Re-ejecuta 'ğŸš€ Ejecutar Screening V3'")
print()

print("CAUSA #3: APP NO ACTUALIZADA (Probabilidad: ğŸŸ¢ BAJA)")
print("-" * 70)
print("Streamlit Cloud no tiene los cambios mÃ¡s recientes")
print()
print("âœ… SOLUCIÃ“N:")
print("   1. Ve a tu dashboard de Streamlit Cloud")
print("   2. Clic en 'Manage app'")
print("   3. Clic en 'Reboot app'")
print("   4. Espera 30-60 segundos")
print("   5. Re-ejecuta el screening")
print()

print("="*80)
print("ğŸš€ ACCIÃ“N RECOMENDADA (HAZLO EN ORDEN)")
print("="*80)
print()

print("PASO 1: Verifica filtro MA200")
print("â”œâ”€ Abre la app de Streamlit")
print("â”œâ”€ En sidebar, secciÃ³n 'ğŸš€ Filtros Avanzados'")
print("â”œâ”€ Verifica que 'âœ… Filtro MA200 (Faber 2007)' estÃ© MARCADO")
print("â””â”€ Si no estÃ¡ marcado, MÃRCALO")
print()

print("PASO 2: Deshabilita cache")
print("â”œâ”€ En sidebar, secciÃ³n 'ğŸ’¾ GestiÃ³n de Datos'")
print("â”œâ”€ DESMARCA 'Usar cachÃ© de precios'")
print("â”œâ”€ DeberÃ­a aparecer un warning amarillo:")
print("â”‚  'âš ï¸ Cache deshabilitado: Se descargarÃ¡n datos frescos'")
print("â””â”€ Haz clic en 'ğŸ—‘ï¸ Limpiar CachÃ©'")
print()

print("PASO 3: Re-ejecuta el screening")
print("â”œâ”€ Haz clic en 'ğŸš€ Ejecutar Screening V3'")
print("â”œâ”€ ESPERA (puede tomar mÃ¡s tiempo sin cache)")
print("â””â”€ Verifica en la salida del PASO 7:")
print("   'âœ… MA200 Filter: ENABLED (Faber 2007)'")
print("   'âš ï¸  Rechazados por MA200: X stocks'")
print()

print("PASO 4: Verifica resultados")
print("â”œâ”€ Los stocks bajo MA200 NO deberÃ­an aparecer")
print("â”œâ”€ PYPL, CPRT, DIS deberÃ­an estar AUSENTES")
print("â””â”€ O aparecer con âŒ en la columna MA200")
print()

print("="*80)
print("ğŸ“ SI EL PROBLEMA PERSISTE")
print("="*80)
print()
print("Si despuÃ©s de hacer TODOS los pasos anteriores")
print("todavÃ­a ves PYPL/CPRT/DIS en los resultados:")
print()
print("1. Toma un screenshot de:")
print("   - La secciÃ³n de filtros del sidebar")
print("   - Los resultados del PASO 7 en la salida")
print("   - La tabla con los stocks finales")
print()
print("2. Copia y pega la salida COMPLETA del PASO 7")
print()
print("3. AvÃ­same y te ayudarÃ© a investigar mÃ¡s a fondo")
print()
print("="*80)
